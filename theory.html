<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°å­—å›¾åƒå¤„ç†åŸç† - ImageProcessLab</title>

    <!-- DNSé¢„è§£æå’Œèµ„æºé¢„åŠ è½½ -->
    <link rel="dns-prefetch" href="//unpkg.com">
    <link rel="preconnect" href="https://unpkg.com" crossorigin>
    <link rel="preload" href="https://unpkg.com/katex@0.16.8/dist/katex.min.css" as="style">
    <link rel="preload" href="https://unpkg.com/katex@0.16.8/dist/katex.min.js" as="script">

    <link rel="stylesheet" href="app-style.css">

    <!-- ä½¿ç”¨å›½å†…CDNæˆ–æœ¬åœ°èµ„æº -->
    <link rel="stylesheet" href="https://unpkg.com/katex@0.16.8/dist/katex.min.css">
    <script defer src="https://unpkg.com/katex@0.16.8/dist/katex.min.js"></script>
    <script defer src="https://unpkg.com/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
    <style>
        .theory-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
            line-height: 1.8;
        }

        .theory-header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 16px;
        }

        .theory-section {
            margin-bottom: 3rem;
            padding: 2rem;
            background: var(--background-light);
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
        }

        .theory-section h2 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }

        .theory-section h3 {
            color: var(--text-color);
            margin: 1.5rem 0 1rem 0;
            font-size: 1.3rem;
        }

        .formula {
            background: var(--background-white);
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            text-align: center;
            overflow-x: auto;
        }

        /* KaTeXæ ·å¼ä¼˜åŒ– */
        .katex-display {
            margin: 1rem 0 !important;
        }

        .katex {
            font-size: 1.1em !important;
        }

        .formula .katex-display {
            margin: 0.5rem 0 !important;
        }

        .inline-math {
            display: inline-block;
            margin: 0 0.2rem;
        }



        .algorithm-box {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid var(--primary-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .algorithm-box h4 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .color-space-demo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .color-demo-item {
            background: var(--background-white);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .color-sample {
            width: 100%;
            height: 60px;
            border-radius: 4px;
            margin-bottom: 0.5rem;
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 0.75rem 1.5rem;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .toc {
            background: var(--background-white);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .toc h3 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .toc ul {
            list-style: none;
            padding-left: 0;
        }

        .toc li {
            margin: 0.5rem 0;
        }

        .toc a {
            color: var(--text-color);
            text-decoration: none;
            padding: 0.25rem 0;
            display: block;
            border-radius: 4px;
            padding-left: 1rem;
            transition: all 0.3s ease;
        }

        .toc a:hover {
            background: var(--primary-color);
            color: white;
            padding-left: 1.5rem;
        }

        /* å›ºå®šç›®å½•å¯¼èˆª */
        .floating-toc {
            position: fixed;
            top: 80px;
            right: 20px;
            width: 280px;
            max-height: calc(100vh - 120px);
            background: var(--background-white);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            overflow-y: auto;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .floating-toc.visible {
            transform: translateX(0);
        }

        .floating-toc h4 {
            margin: 0 0 1rem 0;
            color: var(--primary-color);
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .floating-toc ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .floating-toc li {
            margin: 0.3rem 0;
        }

        .floating-toc a {
            color: var(--text-color);
            text-decoration: none;
            padding: 0.4rem 0.8rem;
            display: block;
            border-radius: 4px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .floating-toc a:hover {
            background: var(--background-light);
            border-left-color: var(--primary-color);
        }

        .floating-toc a.active {
            background: var(--primary-color);
            color: white;
            border-left-color: var(--secondary-color);
        }

        /* ç›®å½•åˆ‡æ¢æŒ‰é’® */
        .toc-toggle {
            position: fixed;
            top: 80px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            transition: all 0.3s ease;
        }

        .toc-toggle:hover {
            background: var(--secondary-color);
            transform: scale(1.1);
        }

        .toc-toggle.active {
            background: var(--secondary-color);
        }

        /* è¿›åº¦æŒ‡ç¤ºå™¨ */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            z-index: 1002;
            transition: width 0.1s ease;
        }

        @media (max-width: 1200px) {
            .floating-toc {
                width: 250px;
            }
        }

        @media (max-width: 768px) {
            .theory-container {
                padding: 1rem;
                margin-right: 0;
            }

            .formula {
                font-size: 0.9rem;
                padding: 1rem;
            }

            .color-space-demo {
                grid-template-columns: 1fr;
            }

            .floating-toc {
                width: calc(100vw - 40px);
                right: 20px;
                left: 20px;
                top: 70px;
                max-height: calc(100vh - 100px);
            }

            .toc-toggle {
                top: 70px;
                right: 30px;
            }

            /* åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šéšè—åŸå§‹ç›®å½• */
            .toc {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .floating-toc {
                width: calc(100vw - 20px);
                right: 10px;
                left: 10px;
                padding: 0.8rem;
            }

            .toc-toggle {
                right: 20px;
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <!-- é˜…è¯»è¿›åº¦æ¡ -->
    <div class="reading-progress"></div>

    <!-- ç›®å½•åˆ‡æ¢æŒ‰é’® -->
    <button class="toc-toggle" id="tocToggle" title="æ˜¾ç¤º/éšè—ç›®å½•">
        ğŸ“š
    </button>

    <!-- æµ®åŠ¨ç›®å½• -->
    <div class="floating-toc" id="floatingToc">
        <h4>
            ğŸ“š ç›®å½•
            <button style="background: none; border: none; color: var(--text-color); cursor: pointer; font-size: 1.2rem;" onclick="toggleFloatingToc()">Ã—</button>
        </h4>
        <ul>
            <li><a href="#introduction" data-section="introduction">1. å¼•è¨€ï¼šçŸ©é˜µç†è®ºä¸å›¾åƒå¤„ç†</a></li>
            <li><a href="#matrix-fundamentals" data-section="matrix-fundamentals">2. çŸ©é˜µç†è®ºåŸºç¡€</a></li>
            <li><a href="#image-representation" data-section="image-representation">3. æ•°å­—å›¾åƒçš„çŸ©é˜µè¡¨ç¤º</a></li>
            <li><a href="#linear-transforms" data-section="linear-transforms">4. çº¿æ€§å˜æ¢ä¸å›¾åƒå¤„ç†</a></li>
            <li><a href="#matrix-encryption" data-section="matrix-encryption">5. åŸºäºçŸ©é˜µçš„å›¾åƒåŠ å¯†</a></li>
            <li><a href="#watermark-theory" data-section="watermark-theory">6. æ•°å­—æ°´å°çš„æ•°å­¦æ¨¡å‹</a></li>
        </ul>
    </div>

    <a href="app.html" class="back-btn">â† è¿”å›ä¸»é¡µ</a>

    <div class="theory-container">
        <div class="theory-header">
            <h1>çŸ©é˜µç†è®ºåœ¨æ•°å­—å›¾åƒå¤„ç†ä¸­çš„åº”ç”¨</h1>
            <p>ä»çº¿æ€§ä»£æ•°åŸºç¡€åˆ°å›¾åƒå¤„ç†ç®—æ³•çš„æ•°å­¦åŸç†</p>
        </div>

        <!-- ç›®å½• -->
        <div class="toc">
            <h3>ğŸ“š ç›®å½•</h3>
            <ul>
                <li><a href="#introduction">1. å¼•è¨€ï¼šçŸ©é˜µç†è®ºä¸å›¾åƒå¤„ç†</a></li>
                <li><a href="#matrix-fundamentals">2. çŸ©é˜µç†è®ºåŸºç¡€</a></li>
                <li><a href="#image-representation">3. æ•°å­—å›¾åƒçš„çŸ©é˜µè¡¨ç¤º</a></li>
                <li><a href="#linear-transforms">4. çº¿æ€§å˜æ¢ä¸å›¾åƒå¤„ç†</a></li>
                <li><a href="#matrix-encryption">5. åŸºäºçŸ©é˜µçš„å›¾åƒåŠ å¯†</a></li>
                <li><a href="#watermark-theory">6. æ•°å­—æ°´å°çš„æ•°å­¦æ¨¡å‹</a></li>
            </ul>
        </div>

        <!-- 1. å¼•è¨€ï¼šçŸ©é˜µç†è®ºä¸å›¾åƒå¤„ç† -->
        <div class="theory-section" id="introduction">
            <h2>1. å¼•è¨€ï¼šçŸ©é˜µç†è®ºä¸å›¾åƒå¤„ç†</h2>

            <h3>1.1 çŸ©é˜µç†è®ºçš„é‡è¦æ€§</h3>
            <p>
                çŸ©é˜µç†è®ºæ˜¯çº¿æ€§ä»£æ•°çš„æ ¸å¿ƒå†…å®¹ï¼Œä¸ºç°ä»£ç§‘å­¦æŠ€æœ¯æä¾›äº†å¼ºæœ‰åŠ›çš„æ•°å­¦å·¥å…·ã€‚åœ¨æ•°å­—å›¾åƒå¤„ç†é¢†åŸŸï¼Œ
                çŸ©é˜µä¸ä»…æ˜¯æ•°æ®è¡¨ç¤ºçš„è‡ªç„¶å½¢å¼ï¼Œæ›´æ˜¯ç®—æ³•è®¾è®¡çš„ç†è®ºåŸºç¡€ã€‚
            </p>

            <h3>1.2 å›¾åƒå¤„ç†ä¸­çš„çŸ©é˜µåº”ç”¨</h3>
            <p>
                æ•°å­—å›¾åƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªäºŒç»´æˆ–ä¸‰ç»´æ•°å€¼çŸ©é˜µï¼Œæ¯ä¸ªçŸ©é˜µå…ƒç´ å¯¹åº”å›¾åƒä¸­çš„åƒç´ å€¼ã€‚
                åŸºäºè¿™ç§çŸ©é˜µè¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥è¿ç”¨çº¿æ€§ä»£æ•°çš„ç†è®ºå’Œæ–¹æ³•æ¥ï¼š
            </p>
            <ul>
                <li><strong>å›¾åƒå˜æ¢</strong>ï¼šé€šè¿‡çŸ©é˜µè¿ç®—å®ç°æ—‹è½¬ã€ç¼©æ”¾ã€å¹³ç§»ç­‰å‡ ä½•å˜æ¢</li>
                <li><strong>é¢œè‰²å¤„ç†</strong>ï¼šåˆ©ç”¨çŸ©é˜µä¹˜æ³•è¿›è¡Œé¢œè‰²ç©ºé—´è½¬æ¢</li>
                <li><strong>å›¾åƒåŠ å¯†</strong>ï¼šåŸºäºçŸ©é˜µç½®æ¢å’Œå˜æ¢å®ç°å›¾åƒåŠ å¯†ç®—æ³•</li>
                <li><strong>æ•°å­—æ°´å°</strong>ï¼šè¿ç”¨çŸ©é˜µè¿ç®—åµŒå…¥å’Œæå–æ°´å°ä¿¡æ¯</li>
            </ul>

            <h3>1.3 æœ¬ç« å­¦ä¹ ç›®æ ‡</h3>
            <p>
                é€šè¿‡æœ¬ç« å­¦ä¹ ï¼Œè¯»è€…å°†æŒæ¡ï¼š
            </p>
            <ol>
                <li>çŸ©é˜µç†è®ºåœ¨å›¾åƒå¤„ç†ä¸­çš„åŸºæœ¬æ¦‚å¿µå’Œåº”ç”¨</li>
                <li>æ•°å­—å›¾åƒçš„çŸ©é˜µè¡¨ç¤ºæ–¹æ³•</li>
                <li>åŸºäºçŸ©é˜µè¿ç®—çš„å›¾åƒå¤„ç†ç®—æ³•åŸç†</li>
                <li>çº¿æ€§å˜æ¢åœ¨å›¾åƒå¤„ç†ä¸­çš„å…·ä½“åº”ç”¨</li>
            </ol>
        </div>

        <!-- 2. çŸ©é˜µç†è®ºåŸºç¡€ -->
        <div class="theory-section" id="matrix-fundamentals">
            <h2>2. çŸ©é˜µç†è®ºåŸºç¡€</h2>

            <h3>2.1 çŸ©é˜µçš„å®šä¹‰ä¸è¡¨ç¤º</h3>
            <p>çŸ©é˜µæ˜¯æŒ‰çŸ©å½¢é˜µåˆ—æ’åˆ—çš„æ•°çš„é›†åˆã€‚ä¸€ä¸ª$m \times n$çŸ©é˜µ$\mathbf{A}$å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
            <div class="formula">
                $$\mathbf{A} = \begin{bmatrix}
                a_{11} & a_{12} & \cdots & a_{1n} \\
                a_{21} & a_{22} & \cdots & a_{2n} \\
                \vdots & \vdots & \ddots & \vdots \\
                a_{m1} & a_{m2} & \cdots & a_{mn}
                \end{bmatrix}$$
            </div>
            <p>å…¶ä¸­$a_{ij}$è¡¨ç¤ºçŸ©é˜µç¬¬$i$è¡Œç¬¬$j$åˆ—çš„å…ƒç´ ã€‚</p>

            <h3>2.2 çŸ©é˜µçš„åŸºæœ¬è¿ç®—</h3>

            <div class="algorithm-box">
                <h4>çŸ©é˜µåŠ æ³•</h4>
                <p>è®¾$\mathbf{A} = (a_{ij})_{m \times n}$ï¼Œ$\mathbf{B} = (b_{ij})_{m \times n}$ï¼Œåˆ™ï¼š</p>
                <div class="formula">
                    $$\mathbf{C} = \mathbf{A} + \mathbf{B} = (a_{ij} + b_{ij})_{m \times n}$$
                </div>
            </div>

            <div class="algorithm-box">
                <h4>çŸ©é˜µä¹˜æ³•</h4>
                <p>è®¾$\mathbf{A} = (a_{ik})_{m \times p}$ï¼Œ$\mathbf{B} = (b_{kj})_{p \times n}$ï¼Œåˆ™ï¼š</p>
                <div class="formula">
                    $$\mathbf{C} = \mathbf{A}\mathbf{B} = \left(\sum_{k=1}^{p} a_{ik}b_{kj}\right)_{m \times n}$$
                </div>
                <p>çŸ©é˜µä¹˜æ³•æ»¡è¶³ç»“åˆå¾‹ä½†ä¸æ»¡è¶³äº¤æ¢å¾‹ï¼š$\mathbf{A}\mathbf{B} \neq \mathbf{B}\mathbf{A}$ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼‰</p>
            </div>

            <h3>2.3 ç‰¹æ®ŠçŸ©é˜µ</h3>

            <div class="algorithm-box">
                <h4>å•ä½çŸ©é˜µ</h4>
                <p>$n$é˜¶å•ä½çŸ©é˜µ$\mathbf{I}_n$çš„å®šä¹‰ï¼š</p>
                <div class="formula">
                    $$\mathbf{I}_n = \begin{bmatrix}
                    1 & 0 & \cdots & 0 \\
                    0 & 1 & \cdots & 0 \\
                    \vdots & \vdots & \ddots & \vdots \\
                    0 & 0 & \cdots & 1
                    \end{bmatrix}$$
                </div>
                <p>æ€§è´¨ï¼š$\mathbf{A}\mathbf{I} = \mathbf{I}\mathbf{A} = \mathbf{A}$</p>
            </div>

            <div class="algorithm-box">
                <h4>ç½®æ¢çŸ©é˜µ</h4>
                <p>ç½®æ¢çŸ©é˜µæ˜¯æ¯è¡Œæ¯åˆ—éƒ½æ°å¥½æœ‰ä¸€ä¸ª1ï¼Œå…¶ä½™å…ƒç´ ä¸º0çš„çŸ©é˜µã€‚ä¾‹å¦‚ï¼š</p>
                <div class="formula">
                    $$\mathbf{P} = \begin{bmatrix}
                    0 & 1 & 0 \\
                    0 & 0 & 1 \\
                    1 & 0 & 0
                    \end{bmatrix}$$
                </div>
                <p>ç½®æ¢çŸ©é˜µç”¨äºé‡æ–°æ’åˆ—çŸ©é˜µçš„è¡Œæˆ–åˆ—ï¼Œåœ¨å›¾åƒåŠ å¯†ä¸­æœ‰é‡è¦åº”ç”¨ã€‚</p>
            </div>
        </div>

        <!-- 3. æ•°å­—å›¾åƒçš„çŸ©é˜µè¡¨ç¤º -->
        <div class="theory-section" id="image-representation">
            <h2>3. æ•°å­—å›¾åƒçš„çŸ©é˜µè¡¨ç¤º</h2>
            
            <h3>3.1 ä»è¿ç»­å›¾åƒåˆ°ç¦»æ•£çŸ©é˜µ</h3>
            <p>
                è‡ªç„¶ç•Œä¸­çš„å›¾åƒæ˜¯è¿ç»­çš„äºŒç»´å‡½æ•°$f(x,y)$ï¼Œå…¶ä¸­$(x,y)$è¡¨ç¤ºç©ºé—´åæ ‡ï¼Œ$f$è¡¨ç¤ºè¯¥ç‚¹çš„äº®åº¦å€¼ã€‚
                æ•°å­—å›¾åƒå¤„ç†éœ€è¦å°†è¿ç»­å›¾åƒç¦»æ•£åŒ–ä¸ºçŸ©é˜µå½¢å¼ï¼Œè¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬é‡‡æ ·å’Œé‡åŒ–ä¸¤ä¸ªæ­¥éª¤ã€‚
            </p>

            <h3>3.2 å›¾åƒçš„çŸ©é˜µè¡¨ç¤º</h3>
            <p>æ•°å­—å›¾åƒå¯ä»¥ç”¨çŸ©é˜µæ¥è¡¨ç¤ºï¼Œå…¶ä¸­æ¯ä¸ªçŸ©é˜µå…ƒç´ å¯¹åº”å›¾åƒä¸­çš„ä¸€ä¸ªåƒç´ ç‚¹ã€‚</p>
            
            <div class="algorithm-box">
                <h4>ç°åº¦å›¾åƒ</h4>
                <p>ç°åº¦å›¾åƒå¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªäºŒç»´çŸ©é˜µï¼š</p>
                <div class="formula">
                    $$I = \begin{bmatrix}
                    I(0,0) & I(0,1) & \cdots & I(0,n-1) \\
                    I(1,0) & I(1,1) & \cdots & I(1,n-1) \\
                    \vdots & \vdots & \ddots & \vdots \\
                    I(m-1,0) & I(m-1,1) & \cdots & I(m-1,n-1)
                    \end{bmatrix}$$
                </div>
                <p>å…¶ä¸­ $I(x,y) \in [0, 255]$ è¡¨ç¤ºä½ç½® $(x,y)$ å¤„åƒç´ çš„ç°åº¦å€¼ã€‚</p>
            </div>

            <div class="algorithm-box">
                <h4>å½©è‰²å›¾åƒï¼ˆRGBï¼‰</h4>
                <p>å½©è‰²å›¾åƒç”±ä¸‰ä¸ªé¢œè‰²é€šé“ç»„æˆï¼Œå¯ä»¥è¡¨ç¤ºä¸ºä¸‰ç»´çŸ©é˜µï¼š</p>
                <div class="formula">
                    $$I_{RGB}(x,y) = \begin{bmatrix} R(x,y) \\ G(x,y) \\ B(x,y) \end{bmatrix}$$
                </div>
                <p>å…¶ä¸­ï¼š</p>
                <ul>
                    <li>$R(x,y) \in [0, 255]$ - çº¢è‰²åˆ†é‡</li>
                    <li>$G(x,y) \in [0, 255]$ - ç»¿è‰²åˆ†é‡</li>
                    <li>$B(x,y) \in [0, 255]$ - è“è‰²åˆ†é‡</li>
                </ul>
            </div>
        </div>

        <!-- 4. çº¿æ€§å˜æ¢ä¸å›¾åƒå¤„ç† -->
        <div class="theory-section" id="linear-transforms">
            <h2>4. çº¿æ€§å˜æ¢ä¸å›¾åƒå¤„ç†</h2>

            <h3>4.1 é¢œè‰²ç©ºé—´çš„çŸ©é˜µè¡¨ç¤º</h3>
            <p>é¢œè‰²ç©ºé—´è½¬æ¢æœ¬è´¨ä¸Šæ˜¯çº¿æ€§å˜æ¢ï¼Œå¯ä»¥ç”¨çŸ©é˜µä¹˜æ³•æ¥å®ç°ã€‚</p>

            <div class="algorithm-box">
                <h4>RGBé¢œè‰²ç©ºé—´</h4>
                <p>RGBé¢œè‰²ç©ºé—´åŸºäºä¸‰åŸè‰²çš„çº¿æ€§ç»„åˆã€‚å¯¹äºåƒç´ ç‚¹$(x,y)$ï¼Œå…¶é¢œè‰²å‘é‡ä¸ºï¼š</p>
                <div class="formula">
                    $$\mathbf{c}(x,y) = \begin{bmatrix} R(x,y) \\ G(x,y) \\ B(x,y) \end{bmatrix}$$
                </div>
                <p>å…¶ä¸­ $R, G, B \in [0, 255]$ åˆ†åˆ«è¡¨ç¤ºçº¢ã€ç»¿ã€è“ä¸‰ä¸ªé¢œè‰²åˆ†é‡ã€‚</p>
            </div>

            <h3>4.2 ç°åº¦åŒ–çš„çŸ©é˜µå˜æ¢</h3>
            <p>ç°åº¦åŒ–æ˜¯å°†å½©è‰²å›¾åƒè½¬æ¢ä¸ºç°åº¦å›¾åƒçš„çº¿æ€§å˜æ¢è¿‡ç¨‹ï¼Œå¯ä»¥ç”¨çŸ©é˜µä¹˜æ³•è¡¨ç¤ºï¼š</p>

            <div class="algorithm-box">
                <h4>ç°åº¦åŒ–å˜æ¢çŸ©é˜µ</h4>
                <p>RGBåˆ°ç°åº¦çš„è½¬æ¢å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
                <div class="formula">
                    $$\text{Gray} = \begin{bmatrix} 0.299 & 0.587 & 0.114 \end{bmatrix} \begin{bmatrix} R \\ G \\ B \end{bmatrix}$$
                </div>
                <p>è¿™ä¸ªå˜æ¢çŸ©é˜µ$\mathbf{W} = [0.299, 0.587, 0.114]$åŸºäºäººçœ¼è§†è§‰ç‰¹æ€§ç¡®å®šï¼Œä½“ç°äº†äººçœ¼å¯¹ä¸åŒé¢œè‰²çš„æ•æ„Ÿåº¦å·®å¼‚ã€‚</p>
            </div>

            <div class="algorithm-box">
                <h4>å…¶ä»–ç°åº¦åŒ–å˜æ¢</h4>
                <p><strong>ç®€å•å¹³å‡æ³•ï¼š</strong></p>
                <div class="formula">
                    $$\text{Gray} = \begin{bmatrix} \frac{1}{3} & \frac{1}{3} & \frac{1}{3} \end{bmatrix} \begin{bmatrix} R \\ G \\ B \end{bmatrix}$$
                </div>

                <p><strong>æœ€å¤§å€¼æ³•ï¼š</strong></p>
                <div class="formula">$$\text{Gray} = \max(R, G, B)$$</div>
                <p>æ³¨ï¼šæœ€å¤§å€¼æ³•ä¸æ˜¯çº¿æ€§å˜æ¢ï¼Œä½†åœ¨æŸäº›åº”ç”¨ä¸­æœ‰ç‰¹æ®Šç”¨é€”ã€‚</p>
            </div>

            <h3>4.3 å‡ ä½•å˜æ¢çš„çŸ©é˜µè¡¨ç¤º</h3>
            <p>å‡ ä½•å˜æ¢æ˜¯å›¾åƒå¤„ç†ä¸­çš„é‡è¦æ“ä½œï¼Œå¯ä»¥ç”¨é½æ¬¡åæ ‡ç³»ç»Ÿå’Œå˜æ¢çŸ©é˜µæ¥ç»Ÿä¸€è¡¨ç¤ºã€‚</p>

            <div class="algorithm-box">
                <h4>é½æ¬¡åæ ‡ç³»ç»Ÿ</h4>
                <p>åœ¨é½æ¬¡åæ ‡ç³»ç»Ÿä¸­ï¼ŒäºŒç»´ç‚¹$(x,y)$è¡¨ç¤ºä¸ºä¸‰ç»´å‘é‡$(x,y,1)^T$ï¼š</p>
                <div class="formula">
                    $$\mathbf{p} = \begin{bmatrix} x \\ y \\ 1 \end{bmatrix}$$
                </div>
                <p>è¿™æ ·å¯ä»¥ç”¨$3 \times 3$çŸ©é˜µç»Ÿä¸€è¡¨ç¤ºå¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ç­‰å˜æ¢ã€‚</p>
            </div>
            <h3>4.4 åŸºæœ¬å‡ ä½•å˜æ¢çŸ©é˜µ</h3>

            <div class="algorithm-box">
                <h4>å¹³ç§»å˜æ¢</h4>
                <p>å°†å›¾åƒåœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šç§»åŠ¨ï¼š</p>
                <div class="formula">
                    $$\mathbf{T}(d_x, d_y) = \begin{bmatrix} 1 & 0 & d_x \\ 0 & 1 & d_y \\ 0 & 0 & 1 \end{bmatrix}$$
                </div>
                <p>å˜æ¢åçš„åæ ‡ï¼š$\mathbf{p}' = \mathbf{T} \mathbf{p}$</p>
            </div>

            <div class="algorithm-box">
                <h4>ç¼©æ”¾å˜æ¢</h4>
                <p>æ”¹å˜å›¾åƒçš„å°ºå¯¸ï¼š</p>
                <div class="formula">
                    $$\mathbf{S}(s_x, s_y) = \begin{bmatrix} s_x & 0 & 0 \\ 0 & s_y & 0 \\ 0 & 0 & 1 \end{bmatrix}$$
                </div>
                <p>å…¶ä¸­$s_x, s_y$åˆ†åˆ«ä¸ºæ°´å¹³å’Œå‚ç›´æ–¹å‘çš„ç¼©æ”¾å› å­ã€‚</p>
            </div>

            <div class="algorithm-box">
                <h4>æ—‹è½¬å˜æ¢</h4>
                <p>ç»•åŸç‚¹é€†æ—¶é’ˆæ—‹è½¬è§’åº¦$\theta$ï¼š</p>
                <div class="formula">
                    $$\mathbf{R}(\theta) = \begin{bmatrix} \cos\theta & -\sin\theta & 0 \\ \sin\theta & \cos\theta & 0 \\ 0 & 0 & 1 \end{bmatrix}$$
                </div>
                <p>æ—‹è½¬å˜æ¢æ˜¯æ­£äº¤å˜æ¢ï¼Œæ»¡è¶³$\mathbf{R}^{-1} = \mathbf{R}^T$ã€‚</p>
            </div>

            <h3>4.5 å¤åˆå˜æ¢</h3>
            <p>å¤šä¸ªå‡ ä½•å˜æ¢å¯ä»¥é€šè¿‡çŸ©é˜µä¹˜æ³•ç»„åˆï¼š</p>
            <div class="formula">
                $$\mathbf{T}_{\text{å¤åˆ}} = \mathbf{T}_n \mathbf{T}_{n-1} \cdots \mathbf{T}_2 \mathbf{T}_1$$
            </div>
            <p>æ³¨æ„ï¼šçŸ©é˜µä¹˜æ³•ä¸æ»¡è¶³äº¤æ¢å¾‹ï¼Œå˜æ¢çš„é¡ºåºä¼šå½±å“æœ€ç»ˆç»“æœã€‚</p>
        </div>

        <!-- 5. åŸºäºçŸ©é˜µçš„å›¾åƒåŠ å¯† -->


        <div class="theory-section" id="matrix-encryption">
            <h2>5. åŸºäºçŸ©é˜µçš„å›¾åƒåŠ å¯†</h2>

            <h3>5.1 ç½®æ¢çŸ©é˜µä¸å›¾åƒç½®ä¹±</h3>
            <p>
                å›¾åƒåŠ å¯†çš„ä¸€ä¸ªé‡è¦æ–¹æ³•æ˜¯åŸºäºç½®æ¢çŸ©é˜µçš„åƒç´ ä½ç½®ç½®ä¹±ã€‚ç½®æ¢çŸ©é˜µæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹é˜µï¼Œ
                æ¯è¡Œæ¯åˆ—éƒ½æ°å¥½æœ‰ä¸€ä¸ª1ï¼Œå…¶ä½™å…ƒç´ ä¸º0ã€‚
            </p>

            <div class="algorithm-box">
                <h4>ç½®æ¢çŸ©é˜µçš„æ€§è´¨</h4>
                <p>è®¾$\mathbf{P}$ä¸º$n \times n$ç½®æ¢çŸ©é˜µï¼Œåˆ™ï¼š</p>
                <ul>
                    <li>$\mathbf{P}^T \mathbf{P} = \mathbf{I}$ï¼ˆæ­£äº¤çŸ©é˜µï¼‰</li>
                    <li>$\mathbf{P}^{-1} = \mathbf{P}^T$ï¼ˆé€†çŸ©é˜µç­‰äºè½¬ç½®ï¼‰</li>
                    <li>$\det(\mathbf{P}) = \pm 1$ï¼ˆè¡Œåˆ—å¼ä¸ºÂ±1ï¼‰</li>
                </ul>
            </div>

            <h3>5.2 è¡Œåˆ—ç½®ä¹±åŠ å¯†ç®—æ³•</h3>
            <p>é€šè¿‡ç½®æ¢çŸ©é˜µé‡æ–°æ’åˆ—å›¾åƒçŸ©é˜µçš„è¡Œå’Œåˆ—ï¼Œå®ç°å›¾åƒåŠ å¯†ã€‚</p>

            <div class="algorithm-box">
                <h4>è¡Œç½®ä¹±çš„çŸ©é˜µè¡¨ç¤º</h4>
                <p>è®¾å›¾åƒçŸ©é˜µä¸º$\mathbf{I}_{m \times n}$ï¼Œè¡Œç½®æ¢çŸ©é˜µä¸º$\mathbf{P}_r$ï¼Œåˆ™è¡Œç½®ä¹±å¯è¡¨ç¤ºä¸ºï¼š</p>
                <div class="formula">
                    $$\mathbf{I}' = \mathbf{P}_r \mathbf{I}$$
                </div>
                <p>å…¶ä¸­$\mathbf{P}_r$æ˜¯$m \times m$çš„ç½®æ¢çŸ©é˜µã€‚è§£å¯†æ—¶ï¼š</p>
                <div class="formula">
                    $$\mathbf{I} = \mathbf{P}_r^{-1} \mathbf{I}' = \mathbf{P}_r^T \mathbf{I}'$$
                </div>
            </div>

            <div class="algorithm-box">
                <h4>åˆ—ç½®ä¹±çš„çŸ©é˜µè¡¨ç¤º</h4>
                <p>åˆ—ç½®ä¹±å¯è¡¨ç¤ºä¸ºå³ä¹˜ç½®æ¢çŸ©é˜µï¼š</p>
                <div class="formula">
                    $$\mathbf{I}' = \mathbf{I} \mathbf{P}_c$$
                </div>
                <p>å…¶ä¸­$\mathbf{P}_c$æ˜¯$n \times n$çš„ç½®æ¢çŸ©é˜µã€‚</p>
            </div>

            <div class="algorithm-box">
                <h4>è¡Œåˆ—ç»„åˆç½®ä¹±</h4>
                <p>åŒæ—¶è¿›è¡Œè¡Œåˆ—ç½®ä¹±ï¼š</p>
                <div class="formula">
                    $$\mathbf{I}' = \mathbf{P}_r \mathbf{I} \mathbf{P}_c$$
                </div>
                <p>è¿™ç§åŒé‡ç½®ä¹±æä¾›äº†æ›´å¼ºçš„åŠ å¯†æ•ˆæœã€‚</p>
            </div>

            <h3>5.3 Arnoldå˜æ¢</h3>
            <p>Arnoldå˜æ¢ï¼ˆçŒ«æ˜ å°„ï¼‰æ˜¯ä¸€ç§åŸºäºçº¿æ€§å˜æ¢çš„æ··æ²ŒåŠ å¯†æ–¹æ³•ï¼Œç”±æ•°å­¦å®¶Vladimir Arnoldæå‡ºã€‚</p>

            <div class="algorithm-box">
                <h4>Arnoldå˜æ¢å…¬å¼</h4>
                <p>å¯¹äº$N \times N$çš„æ­£æ–¹å½¢å›¾åƒï¼ŒArnoldå˜æ¢å®šä¹‰ä¸ºï¼š</p>
                <div class="formula">
                    $$\begin{bmatrix} x' \\ y' \end{bmatrix} = \begin{bmatrix} 1 & a \\ b & ab+1 \end{bmatrix} \begin{bmatrix} x \\ y \end{bmatrix} \pmod{N}$$
                </div>
                <p>å…¶ä¸­ $a, b$ ä¸ºæ­£æ•´æ•°å‚æ•°ï¼Œé€šå¸¸å– $a=1, b=1$ã€‚</p>

                <p>å±•å¼€å½¢å¼ï¼š</p>
                <div class="formula">
                    $$\begin{align}
                    x' &= (x + ay) \bmod N \\
                    y' &= (bx + (ab+1)y) \bmod N
                    \end{align}$$
                </div>
            </div>

            <div class="algorithm-box">
                <h4>Arnoldé€†å˜æ¢</h4>
                <p>è§£å¯†æ—¶ä½¿ç”¨Arnoldé€†å˜æ¢ï¼š</p>
                <div class="formula">
                    $$\begin{bmatrix} x \\ y \end{bmatrix} = \begin{bmatrix} ab+1 & -a \\ -b & 1 \end{bmatrix} \begin{bmatrix} x' \\ y' \end{bmatrix} \pmod{N}$$
                </div>

                <p>å±•å¼€å½¢å¼ï¼š</p>
                <div class="formula">
                    $$\begin{align}
                    x &= ((ab+1)x' - ay') \bmod N \\
                    y &= (-bx' + y') \bmod N
                    \end{align}$$
                </div>
            </div>

            <div class="algorithm-box">
                <h4>Arnoldå˜æ¢çš„æ•°å­¦æ€§è´¨</h4>
                <p><strong>1. å¯é€†æ€§ï¼š</strong>Arnoldå˜æ¢çŸ©é˜µçš„è¡Œåˆ—å¼ä¸º1ï¼Œä¿è¯å˜æ¢å¯é€†ã€‚</p>
                <div class="formula">
                    $$\det\begin{bmatrix} 1 & a \\ b & ab+1 \end{bmatrix} = (ab+1) - ab = 1$$
                </div>

                <p><strong>2. å‘¨æœŸæ€§ï¼š</strong>å­˜åœ¨æ­£æ•´æ•°$T$ä½¿å¾—$\mathbf{A}^T \equiv \mathbf{I} \pmod{N}$</p>

                <p><strong>3. æ··æ²Œæ€§ï¼š</strong>ç›¸é‚»åƒç´ ç»å˜æ¢åä½ç½®åˆ†æ•£ï¼Œå…·æœ‰è‰¯å¥½çš„æ‰©æ•£æ•ˆæœã€‚</p>
            </div>
        </div>
        <!-- 6. æ•°å­—æ°´å°çš„æ•°å­¦æ¨¡å‹ -->
        <div class="theory-section" id="watermark-theory">
            <h2>6. æ•°å­—æ°´å°çš„æ•°å­¦æ¨¡å‹</h2>

            <h3>6.1 æ°´å°ç³»ç»Ÿçš„çŸ©é˜µè¡¨ç¤º</h3>
            <p>
                æ•°å­—æ°´å°ç³»ç»Ÿå¯ä»¥ç”¨çŸ©é˜µè¿ç®—æ¥æè¿°ã€‚è®¾åŸå§‹å›¾åƒçŸ©é˜µä¸º$\mathbf{I}$ï¼Œæ°´å°çŸ©é˜µä¸º$\mathbf{W}$ï¼Œ
                åˆ™æ°´å°åµŒå…¥è¿‡ç¨‹å¯ä»¥è¡¨ç¤ºä¸ºï¼š
            </p>

            <div class="algorithm-box">
                <h4>åŠ æ€§æ°´å°æ¨¡å‹</h4>
                <p>æœ€ç®€å•çš„æ°´å°åµŒå…¥æ¨¡å‹ï¼š</p>
                <div class="formula">
                    $$\mathbf{I}' = \mathbf{I} + \alpha \mathbf{W}$$
                </div>
                <p>å…¶ä¸­ï¼š</p>
                <ul>
                    <li>$\mathbf{I}'$ - å«æ°´å°å›¾åƒçŸ©é˜µ</li>
                    <li>$\mathbf{I}$ - åŸå§‹å›¾åƒçŸ©é˜µ</li>
                    <li>$\mathbf{W}$ - æ°´å°çŸ©é˜µ</li>
                    <li>$\alpha$ - æ°´å°å¼ºåº¦ç³»æ•°</li>
                </ul>
            </div>

            <div class="algorithm-box">
                <h4>ä¹˜æ€§æ°´å°æ¨¡å‹</h4>
                <p>è€ƒè™‘å›¾åƒå†…å®¹è‡ªé€‚åº”çš„æ°´å°åµŒå…¥ï¼š</p>
                <div class="formula">
                    $$\mathbf{I}' = \mathbf{I} \odot (\mathbf{1} + \alpha \mathbf{W})$$
                </div>
                <p>å…¶ä¸­$\odot$è¡¨ç¤ºçŸ©é˜µçš„é€å…ƒç´ ä¹˜æ³•ï¼ˆHadamardç§¯ï¼‰ï¼Œ$\mathbf{1}$ä¸ºå…¨1çŸ©é˜µã€‚</p>
            </div>

            <h3>6.2 èƒŒæ™¯é€æ˜åŒ–çš„æ•°å­¦åŸç†</h3>
            <p>åœ¨æ°´å°å¤„ç†ä¸­ï¼Œé¦–å…ˆéœ€è¦å°†æ°´å°å›¾åƒçš„çº¯è‰²èƒŒæ™¯é€æ˜åŒ–ï¼Œè¿™æ¶‰åŠé¢œè‰²ç›¸ä¼¼åº¦æ£€æµ‹å’ŒAlphaé€šé“è®¡ç®—ã€‚</p>

            <div class="algorithm-box">
                <h4>é¢œè‰²è·ç¦»è®¡ç®—</h4>
                <p>ä½¿ç”¨æ¬§å‡ é‡Œå¾—è·ç¦»åˆ¤æ–­åƒç´ æ˜¯å¦ä¸ºèƒŒæ™¯è‰²ï¼š</p>
                <div class="formula">
                    $$d = \sqrt{(R - R_{\text{bg}})^2 + (G - G_{\text{bg}})^2 + (B - B_{\text{bg}})^2}$$
                </div>
                <p>å…¶ä¸­$(R_{\text{bg}}, G_{\text{bg}}, B_{\text{bg}})$ä¸ºèƒŒæ™¯è‰²ï¼Œé€šå¸¸å–å›¾åƒå·¦ä¸Šè§’åƒç´ å€¼ã€‚</p>
            </div>

            <div class="algorithm-box">
                <h4>Alphaé€šé“ç”Ÿæˆ</h4>
                <p>æ ¹æ®é¢œè‰²è·ç¦»ç”ŸæˆAlphaé€æ˜åº¦ï¼š</p>
                <div class="formula">
                    $$\alpha(x,y) = \begin{cases}
                    0 & \text{if } d(x,y) < \text{threshold} \\
                    1 & \text{if } d(x,y) \geq \text{threshold}
                    \end{cases}$$
                </div>
                <p>å…¶ä¸­thresholdä¸ºå®¹å·®é˜ˆå€¼ï¼Œç”¨äºå¤„ç†é¢œè‰²çš„ç»†å¾®å·®å¼‚ã€‚</p>
            </div>

            <h3>6.3 æ­£ç‰‡å åº•æ··åˆæ¨¡å¼</h3>
            <p>æ­£ç‰‡å åº•ï¼ˆMultiplyï¼‰æ˜¯ä¸€ç§é‡è¦çš„å›¾åƒæ··åˆæ¨¡å¼ï¼Œå¹¿æ³›ç”¨äºæ°´å°å’Œå›¾åƒåˆæˆã€‚</p>

            <div class="algorithm-box">
                <h4>æ­£ç‰‡å åº•çš„æ•°å­¦å®šä¹‰</h4>
                <p>æ­£ç‰‡å åº•æ··åˆçš„æ•°å­¦å…¬å¼ä¸ºï¼š</p>
                <div class="formula">
                    $$C_{\text{result}} = \frac{C_{\text{base}} \times C_{\text{blend}}}{255}$$
                </div>
                <p>å¯¹äºå½’ä¸€åŒ–çš„é¢œè‰²å€¼ï¼ˆ[0,1]èŒƒå›´ï¼‰ï¼š</p>
                <div class="formula">
                    $$C_{\text{result}} = C_{\text{base}} \times C_{\text{blend}}$$
                </div>
            </div>

            <div class="algorithm-box">
                <h4>æ­£ç‰‡å åº•çš„çŸ©é˜µè¡¨ç¤º</h4>
                <p>å¯¹äºRGBå›¾åƒï¼Œæ­£ç‰‡å åº•å¯ä»¥è¡¨ç¤ºä¸ºé€å…ƒç´ ä¹˜æ³•ï¼š</p>
                <div class="formula">
                    $$\begin{bmatrix} R' \\ G' \\ B' \end{bmatrix} = \begin{bmatrix} R_{\text{base}} \\ G_{\text{base}} \\ B_{\text{base}} \end{bmatrix} \odot \begin{bmatrix} R_{\text{blend}} \\ G_{\text{blend}} \\ B_{\text{blend}} \end{bmatrix}$$
                </div>
                <p>å…¶ä¸­$\odot$è¡¨ç¤ºHadamardç§¯ï¼ˆé€å…ƒç´ ä¹˜æ³•ï¼‰ã€‚</p>
            </div>

            <div class="algorithm-box">
                <h4>æ­£ç‰‡å åº•çš„ç‰¹æ€§</h4>
                <ul>
                    <li><strong>å˜æš—æ•ˆæœï¼š</strong>ç»“æœæ€»æ˜¯æ¯”åŸè‰²æ›´æš—æˆ–ç›¸ç­‰</li>
                    <li><strong>ç™½è‰²é€æ˜ï¼š</strong>ä¸ç™½è‰²æ··åˆä¿æŒåŸè‰²ä¸å˜</li>
                    <li><strong>é»‘è‰²å¸æ”¶ï¼š</strong>ä¸é»‘è‰²æ··åˆç»“æœä¸ºé»‘è‰²</li>
                    <li><strong>äº¤æ¢å¾‹ï¼š</strong>$A \times B = B \times A$</li>
                </ul>
            </div>
            <h3>6.4 ç»¼åˆæ°´å°å¤„ç†æµç¨‹</h3>
            <p>å®Œæ•´çš„æ°´å°å¤„ç†åŒ…æ‹¬èƒŒæ™¯é€æ˜åŒ–ã€å‡ ä½•å˜æ¢å’Œæ··åˆæ¨¡å¼çš„ç»¼åˆåº”ç”¨ã€‚</p>

            <div class="algorithm-box">
                <h4>æ°´å°é¢„å¤„ç†</h4>
                <p><strong>æ­¥éª¤1ï¼šèƒŒæ™¯é€æ˜åŒ–</strong></p>
                <div class="formula">
                    $$\mathbf{W}_{\alpha}(x,y) = \begin{cases}
                    \mathbf{W}(x,y) & \text{if } d(x,y) \geq \text{threshold} \\
                    \text{transparent} & \text{if } d(x,y) < \text{threshold}
                    \end{cases}$$
                </div>

                <p><strong>æ­¥éª¤2ï¼šå‡ ä½•å˜æ¢</strong></p>
                <div class="formula">
                    $$\mathbf{W}'_{\alpha} = \mathbf{T} \cdot \mathbf{W}_{\alpha}$$
                </div>
                <p>å…¶ä¸­$\mathbf{T}$ä¸ºä»¿å°„å˜æ¢çŸ©é˜µã€‚</p>
            </div>

            <div class="algorithm-box">
                <h4>æ°´å°èåˆ</h4>
                <p>ç»“åˆAlphaæ··åˆå’Œæ­£ç‰‡å åº•çš„æ··åˆå…¬å¼ï¼š</p>
                <div class="formula">
                    $$\mathbf{I}'(x,y) = \begin{cases}
                    \mathbf{I}(x,y) \odot \mathbf{W}'(x,y) & \text{æ­£ç‰‡å åº•æ¨¡å¼} \\
                    (1-\alpha)\mathbf{I}(x,y) + \alpha\mathbf{W}'(x,y) & \text{Alphaæ··åˆæ¨¡å¼}
                    \end{cases}$$
                </div>
                <p>é€‰æ‹©åˆé€‚çš„æ··åˆæ¨¡å¼å¯ä»¥è·å¾—ä¸åŒçš„è§†è§‰æ•ˆæœã€‚</p>
            </div>

            <div class="algorithm-box">
                <h4>æ•°å­¦ç‰¹æ€§æ€»ç»“</h4>
                <ul>
                    <li><strong>ä¿çœŸæ€§ï¼š</strong>é€æ˜åŒºåŸŸä¸å½±å“åŸå›¾åƒ</li>
                    <li><strong>å¯æ§æ€§ï¼š</strong>é€šè¿‡å‚æ•°è°ƒèŠ‚æ°´å°å¼ºåº¦</li>
                    <li><strong>å¯é€†æ€§ï¼š</strong>ç†è®ºä¸Šå¯ä»¥æå–æ°´å°ä¿¡æ¯</li>
                    <li><strong>é²æ£’æ€§ï¼š</strong>å¯¹è½»å¾®çš„å›¾åƒå˜åŒ–å…·æœ‰æŠ—æ€§</li>
                </ul>
            </div>
        </div>


    </div>

    <script>
        // æµ®åŠ¨ç›®å½•æ§åˆ¶
        let floatingTocVisible = false;

        function toggleFloatingToc() {
            const floatingToc = document.getElementById('floatingToc');
            const tocToggle = document.getElementById('tocToggle');

            floatingTocVisible = !floatingTocVisible;

            if (floatingTocVisible) {
                floatingToc.classList.add('visible');
                tocToggle.classList.add('active');
                tocToggle.innerHTML = 'Ã—';
            } else {
                floatingToc.classList.remove('visible');
                tocToggle.classList.remove('active');
                tocToggle.innerHTML = 'ğŸ“š';
            }
        }

        // ç›®å½•åˆ‡æ¢æŒ‰é’®äº‹ä»¶
        document.getElementById('tocToggle').addEventListener('click', toggleFloatingToc);

        // é˜…è¯»è¿›åº¦æ›´æ–°
        function updateReadingProgress() {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
            const progress = (scrollTop / scrollHeight) * 100;

            document.querySelector('.reading-progress').style.width = progress + '%';
        }

        // å½“å‰ç« èŠ‚é«˜äº®
        function updateActiveSection() {
            const sections = document.querySelectorAll('.theory-section');
            const tocLinks = document.querySelectorAll('.floating-toc a');

            let currentSection = '';
            const scrollTop = window.pageYOffset + 100; // åç§»é‡

            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;

                if (scrollTop >= sectionTop && scrollTop < sectionTop + sectionHeight) {
                    currentSection = section.id;
                }
            });

            // æ›´æ–°ç›®å½•é“¾æ¥çŠ¶æ€
            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-section') === currentSection) {
                    link.classList.add('active');
                }
            });
        }

        // æ»šåŠ¨äº‹ä»¶ç›‘å¬
        window.addEventListener('scroll', () => {
            updateReadingProgress();
            updateActiveSection();
        });

        // å¹³æ»‘æ»šåŠ¨åˆ°é”šç‚¹
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });

                    // åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šç‚¹å‡»ç›®å½•é¡¹åè‡ªåŠ¨éšè—ç›®å½•
                    if (window.innerWidth <= 768 && floatingTocVisible) {
                        setTimeout(() => {
                            toggleFloatingToc();
                        }, 500);
                    }
                }
            });
        });

        // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹éšè—æµ®åŠ¨ç›®å½•
        document.addEventListener('click', function(e) {
            const floatingToc = document.getElementById('floatingToc');
            const tocToggle = document.getElementById('tocToggle');

            if (floatingTocVisible &&
                !floatingToc.contains(e.target) &&
                !tocToggle.contains(e.target)) {
                toggleFloatingToc();
            }
        });

        // é”®ç›˜å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', function(e) {
            // æŒ‰ T é”®åˆ‡æ¢ç›®å½•
            if (e.key === 't' || e.key === 'T') {
                if (!e.ctrlKey && !e.altKey && !e.metaKey) {
                    e.preventDefault();
                    toggleFloatingToc();
                }
            }
            // æŒ‰ ESC é”®éšè—ç›®å½•
            if (e.key === 'Escape' && floatingTocVisible) {
                toggleFloatingToc();
            }
        });

        // ä¸»é¢˜åˆ‡æ¢æ”¯æŒ
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            document.documentElement.setAttribute('data-theme', savedTheme);
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateReadingProgress();
            updateActiveSection();

            // åœ¨å¤§å±å¹•ä¸Šé»˜è®¤æ˜¾ç¤ºç›®å½•
            if (window.innerWidth > 1200) {
                setTimeout(() => {
                    toggleFloatingToc();
                }, 1000);
            }
        });

        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoadingStatus() {
            const loadingDiv = document.createElement('div');
            loadingDiv.id = 'math-loading';
            loadingDiv.style.cssText = `
                position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                background: rgba(0,0,0,0.8); color: white; padding: 20px;
                border-radius: 8px; z-index: 9999; font-size: 16px;
            `;
            loadingDiv.innerHTML = 'æ­£åœ¨åŠ è½½æ•°å­¦å…¬å¼æ¸²æŸ“å™¨...';
            document.body.appendChild(loadingDiv);
        }

        function hideLoadingStatus() {
            const loadingDiv = document.getElementById('math-loading');
            if (loadingDiv) {
                loadingDiv.remove();
            }
        }

        // å¤‡ç”¨æ¸²æŸ“æ–¹æ¡ˆï¼šä½¿ç”¨ç®€å•çš„æ–‡æœ¬æ›¿æ¢
        function fallbackMathRender() {
            console.log('ä½¿ç”¨å¤‡ç”¨æ•°å­¦å…¬å¼æ¸²æŸ“æ–¹æ¡ˆ');
            const formulas = document.querySelectorAll('.formula');
            formulas.forEach(formula => {
                let content = formula.innerHTML;
                // ç®€å•çš„LaTeXç¬¦å·æ›¿æ¢
                content = content.replace(/\$\$([^$]+)\$\$/g, '<em style="font-family: serif; font-style: italic;">$1</em>');
                content = content.replace(/\$([^$]+)\$/g, '<em style="font-family: serif; font-style: italic;">$1</em>');
                content = content.replace(/\\mathbf\{([^}]+)\}/g, '<strong>$1</strong>');
                content = content.replace(/\\text\{([^}]+)\}/g, '$1');
                content = content.replace(/\\times/g, 'Ã—');
                content = content.replace(/\\cdot/g, 'Â·');
                content = content.replace(/\\alpha/g, 'Î±');
                content = content.replace(/\\beta/g, 'Î²');
                content = content.replace(/\\theta/g, 'Î¸');
                content = content.replace(/\\Delta/g, 'Î”');
                content = content.replace(/\\odot/g, 'âŠ™');
                formula.innerHTML = content;
            });
        }

        // åˆå§‹åŒ–KaTeXæ¸²æŸ“
        document.addEventListener("DOMContentLoaded", function() {
            showLoadingStatus();

            let katexLoaded = false;

            // æ£€æŸ¥KaTeXæ˜¯å¦åŠ è½½æˆåŠŸ
            function checkKaTeX() {
                if (typeof renderMathInElement !== 'undefined' && !katexLoaded) {
                    katexLoaded = true;
                    try {
                        renderMathInElement(document.body, {
                            delimiters: [
                                {left: "$$", right: "$$", display: true},
                                {left: "$", right: "$", display: false},
                                {left: "\\[", right: "\\]", display: true},
                                {left: "\\(", right: "\\)", display: false}
                            ],
                            throwOnError: false,
                            errorColor: '#cc0000',
                            strict: false,
                            trust: false,
                            macros: {
                                "\\text": "\\textrm"
                            }
                        });
                        hideLoadingStatus();
                        console.log('KaTeXæ•°å­¦å…¬å¼æ¸²æŸ“å®Œæˆ');
                    } catch (error) {
                        console.error('KaTeXæ¸²æŸ“é”™è¯¯:', error);
                        fallbackMathRender();
                        hideLoadingStatus();
                    }
                } else if (!katexLoaded) {
                    // å¦‚æœKaTeXè¿˜æ²¡åŠ è½½ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•
                    setTimeout(checkKaTeX, 100);
                }
            }

            // è®¾ç½®è¶…æ—¶ï¼Œå¦‚æœ5ç§’åè¿˜æ²¡åŠ è½½æˆåŠŸå°±ä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ
            setTimeout(() => {
                if (!katexLoaded) {
                    console.warn('KaTeXåŠ è½½è¶…æ—¶ï¼Œä½¿ç”¨å¤‡ç”¨æ¸²æŸ“æ–¹æ¡ˆ');
                    fallbackMathRender();
                    hideLoadingStatus();
                }
            }, 5000);

            checkKaTeX();
        });
    </script>
</body>
</html>
